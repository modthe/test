<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quiz Game with Admin Features</title>
<style>
/* Keep all your existing CSS here */
* { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
body { background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%); color: #333; line-height: 1.6; min-height: 100vh; padding: 20px; display: flex; justify-content: center; align-items: center; }
.container { width: 95%; max-width: 1000px; background: white; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); overflow: hidden; }
header { background: linear-gradient(135deg, #6e8efb, #a777e3); color: white; padding: 2rem; text-align: center; position: relative; }
.quiz-timer { position: absolute; top: 10px; right: 20px; background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 20px; font-weight: bold; }
h1 { font-size: 2.2rem; margin-bottom: 1rem; }
.subtitle { font-size: 1.1rem; opacity: 0.9; }
.tabs { display: flex; background: #f0f0f0; border-bottom: 2px solid #ddd; }
.tab { padding: 1rem; cursor: pointer; font-weight: 600; transition: all 0.3s ease; text-align: center; flex: 1; font-size: 0.9rem; }
.tab:hover { background: #e0e0e0; }
.tab.active { background: white; border-bottom: 3px solid #6e8efb; }
.content { padding: 1.5rem; min-height: 500px; }
.tab-content { display: none; }
.tab-content.active { display: block; animation: fadeIn 0.5s ease; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
.card { background: white; border-radius: 10px; padding: 1.5rem; margin: 1.5rem 0; box-shadow: 0 5px 15px rgba(0,0,0,0.08); border-left: 4px solid #6e8efb; }
h2 { font-size: 1.6rem; color: #6e8efb; margin-bottom: 1rem; }
h3 { font-size: 1.3rem; color: #a777e3; margin: 1.2rem 0 0.8rem; }
input, button, select, textarea { padding: 0.8rem 1rem; margin: 0.5rem 0; border-radius: 5px; border: 1px solid #ddd; font-size: 0.9rem; }
input, select, textarea { width: 100%; max-width: 300px; }
textarea { min-height: 100px; resize: vertical; }
button { background: #6e8efb; color: white; border: none; cursor: pointer; transition: all 0.3s ease; font-weight: 600; }
button:hover { background: #5a7df9; transform: translateY(-2px); }
button:disabled { background: #ccc; cursor: not-allowed; transform: none; }
.answer-btn { display: block; width: 100%; text-align: left; margin: 0.5rem 0; padding: 1rem; background: #f8f9fa; color: #333; border: 1px solid #ddd; transition: all 0.2s ease; }
.answer-btn:hover { background: #e9ecef; transform: translateX(5px); }
.answer-btn.correct { background-color: #4caf50; color: white; border-color: #4caf50; }
.answer-btn.incorrect { background-color: #f44336; color: white; border-color: #f44336; }
.instructions { background: #fff8e1; border-left: 4px solid #ffc107; padding: 1.2rem; margin: 1.5rem 0; border-radius: 4px; }
.instructions h3 { color: #ff9800; margin-bottom: 0.8rem; }
.instructions ol { margin-left: 1.5rem; margin-bottom: 1rem; }
.instructions li { margin-bottom: 0.5rem; }
.sheet-config { background: #e8f5e9; border-left: 4px solid #4caf50; padding: 1.2rem; margin: 1.5rem 0; border-radius: 4px; }
.sheet-config h3 { color: #2e7d32; margin-bottom: 0.8rem; }
.code-block { background: #2c3e50; color: #f5f7fa; padding: 1.2rem; border-radius: 8px; font-family: monospace; margin: 1.2rem 0; overflow-x: auto; font-size: 0.9rem; }
.countdown { font-size: 1.4rem; font-weight: bold; text-align: center; margin: 1rem 0; color: #6e8efb; }
.url-status { margin-top: 10px; padding: 8px; border-radius: 4px; text-align: center; font-size: 0.9rem; }
.url-status.success { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
.url-status.error { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
.setup-complete { text-align: center; padding: 1.5rem; background: #e8f5e9; border-radius: 8px; margin: 1.5rem 0; }
.time-info { background: #e3f2fd; border-left: 4px solid #2196f3; padding: 1rem; margin: 1rem 0; border-radius: 4px; }
.time-config { background: #f3e5f5; border-left: 4px solid #9c27b0; padding: 1rem; margin: 1rem 0; border-radius: 4px; }
.time-config h3 { color: #7b1fa2; }
.form-group { margin: 1rem 0; }
label { display: block; margin-bottom: 0.5rem; font-weight: 600; }
.admin-section { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1.2rem; margin: 1.2rem 0; border-radius: 4px; }
.admin-section h3 { color: #ef6c00; }
.question-list { margin: 1rem 0; max-height: 300px; overflow-y: auto; border: 1px solid #ddd; border-radius: 5px; padding: 1rem; background: #f9f9f9; }
.question-item { padding: 0.5rem; border-bottom: 1px solid #eee; }
.question-item:last-child { border-bottom: none; }
.admin-controls { display: flex; gap: 10px; margin-top: 0.5rem; }
.admin-btn { padding: 0.3rem 0.8rem; font-size: 0.8rem; }
.admin-btn.edit { background: #ff9800; }
.admin-btn.delete { background: #f44336; }
.answer-option { display: flex; align-items: center; margin-bottom: 0.5rem; }
.answer-option input[type="text"] { flex: 1; margin-right: 10px; }
.response-time { font-style: italic; color: #666; font-size: 0.9rem; margin-top: 5px; }
.time-input-group { display: flex; align-items: center; gap: 10px; }
.time-input-group input { max-width: 120px; }
.time-input-group select { max-width: 80px; }
@media (max-width: 768px) { .tabs { flex-direction: column; } h1 { font-size: 1.8rem; } .content { padding: 1rem; } .quiz-timer { position: static; margin-top: 10px; display: inline-block; } .admin-controls { flex-direction: column; } .answer-option { flex-direction: column; align-items: flex-start; } .answer-option input[type="text"] { width: 100%; margin-right: 0; margin-bottom: 5px; } .time-input-group { flex-direction: column; align-items: flex-start; } .time-input-group input, .time-input-group select { width: 100%; max-width: none; } }
</style>
</head>
<body>
<div class="container">
<header>
<h1>Quiz Game</h1>
<div class="subtitle">Live Quiz for All Users</div>
<div class="quiz-timer" id="quiz-timer">Loading...</div>
</header>

<div class="tabs">
<div class="tab active" data-tab="instructions">Instructions</div>
<div class="tab" data-tab="quiz">Quiz</div>
<div class="tab" data-tab="admin">Admin</div>
</div>

<div class="content">
<div class="tab-content active" id="instructions">
<div class="instructions">
<h3>How to Play</h3>
<ol>
<li>Wait until the quiz starts.</li>
<li>Select the correct answer for each question.</li>
<li>Your answers will be automatically submitted.</li>
<li>Results are updated in real time.</li>
</ol>
</div>
</div>

<div class="tab-content" id="quiz">
<div id="question-container"></div>
</div>

<div class="tab-content" id="admin">
<div class="admin-section">
<h3>Setup Google Sheet</h3>
<div class="sheet-config">
<label for="sheet-url">Web App URL:</label>
<input type="text" id="sheet-url" placeholder="Enter your Google Apps Script Web App URL">
<button id="save-sheet-url">Save URL</button>
<div id="url-status" class="url-status"></div>
</div>
</div>
</div>
</div>
</div>

<script>
var questions = [];
var currentQuestionIndex = 0;
var quizStartTime = null;
var quizEndTime = null;
var timerInterval = null;

// Tabs
var tabs = document.querySelectorAll('.tab');
var contents = document.querySelectorAll('.tab-content');
tabs.forEach(tab => {
tab.addEventListener('click', () => {
tabs.forEach(t => t.classList.remove('active'));
tab.classList.add('active');
contents.forEach(c => c.classList.remove('active'));
document.getElementById(tab.dataset.tab).classList.add('active');
});
});

// Save Web App URL
document.getElementById('save-sheet-url').addEventListener('click', function() {
var url = document.getElementById('sheet-url').value.trim();
if(url) {
localStorage.setItem('webAppUrl', url);
document.getElementById('url-status').textContent = "Saved successfully!";
document.getElementById('url-status').className = "url-status success";
loadQuizData();
} else {
document.getElementById('url-status').textContent = "Please enter a valid URL.";
document.getElementById('url-status').className = "url-status error";
}
});

// Load Quiz Data
async function loadQuizData() {
var webAppUrl = localStorage.getItem('webAppUrl');
if(!webAppUrl) return;
try {
const response = await fetch(webAppUrl);
const data = await response.json();
questions = data.questions;
quizStartTime = new Date(data.timing[0]).getTime();
quizEndTime = new Date(data.timing[1]).getTime();
updateQuizTimeInfo();
displayQuestions();
} catch(err) {
console.error("Failed to load quiz data:", err);
document.getElementById('quiz-timer').textContent = "Failed to load quiz";
}
}

// Display Questions
function displayQuestions() {
var container = document.getElementById('question-container');
container.innerHTML = '';
if(!questions || questions.length === 0) {
container.innerHTML = "<p>No questions available.</p>";
return;
}
questions.forEach((q,i) => {
var card = document.createElement('div');
card.className = 'card';
var qTitle = document.createElement('h2');
qTitle.textContent = `Q${i+1}: ${q.question}`;
card.appendChild(qTitle);
q.answers.forEach((a,ai) => {
var btn = document.createElement('button');
btn.className = 'answer-btn';
btn.textContent = a;
btn.addEventListener('click', function(){
handleAnswer(i,a,q.correct);
});
card.appendChild(btn);
});
container.appendChild(card);
});
}

// Handle Answer
function handleAnswer(qIndex, answer, correct) {
var status = answer === correct ? "Correct" : "Incorrect";
alert(`You answered: ${answer}\nCorrect answer: ${correct}\nStatus: ${status}`);
sendToGoogleSheet({
player: "Player_" + Math.floor(Math.random()*1000),
question: questions[qIndex].question,
answer: answer,
correct: correct,
responseTime: new Date().toLocaleTimeString(),
status: status
});
}

// Send to Google Sheet
function sendToGoogleSheet(data) {
var webAppUrl = localStorage.getItem('webAppUrl');
if(!webAppUrl) return;
fetch(webAppUrl, {
method: 'POST',
body: JSON.stringify(data)
})
.then(res=>res.json())
.then(res=>console.log("Sent:", res))
.catch(err=>console.error("Error sending:", err));
}

// Quiz Timer
function updateQuizTimeInfo() {
if(!quizStartTime || !quizEndTime) return;
clearInterval(timerInterval);
timerInterval = setInterval(() => {
var now = new Date().getTime();
var remaining = quizEndTime - now;
if(remaining < 0) {
document.getElementById('quiz-timer').textContent = "Quiz Ended";
clearInterval(timerInterval);
return;
}
var minutes = Math.floor((remaining % (1000*60*60)) / (1000*60));
var seconds = Math.floor((remaining % (1000*60)) / 1000);
document.getElementById('quiz-timer').textContent = `Time left: ${minutes}m ${seconds}s`;
},1000);
}

// Initial Load
loadQuizData();
</script>
</body>
</html>
